<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>TempMail Modern</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 text-white min-h-screen flex flex-col items-center">

  <div class="mt-12 w-full max-w-3xl bg-gray-800 p-6 rounded-2xl shadow-xl">
    <h1 class="text-3xl font-bold text-center mb-6">ðŸ“§ TempMail Modern</h1>

    <!-- Email Address -->
    <div class="flex items-center justify-between bg-gray-700 px-4 py-3 rounded-lg">
      <span id="email" class="font-mono text-lg">Loading...</span>
      <button onclick="copyEmail()" class="bg-blue-600 px-3 py-1 rounded-lg hover:bg-blue-700">Copy</button>
    </div>

    <!-- Inbox -->
    <h2 class="text-xl font-semibold mt-6 mb-3">ðŸ“¨ Inbox</h2>
    <div id="inbox" class="space-y-2 bg-gray-700 p-4 rounded-lg h-64 overflow-y-auto">
      <p class="text-gray-400">Menunggu email masuk...</p>
    </div>

    <!-- Refresh -->
    <div class="flex justify-center mt-6">
      <button onclick="loadInbox()" class="bg-green-600 px-4 py-2 rounded-lg hover:bg-green-700">Refresh Inbox</button>
    </div>
  </div>

  <script>
    let email = "";
    let login = "";
    let domain = "";

    // Generate Email
    async function generateEmail() {
      let res = await fetch("https://www.1secmail.com/api/v1/?action=genRandomMailbox&count=1");
      let data = await res.json();
      email = data[0];
      document.getElementById("email").innerText = email;

      let parts = email.split("@");
      login = parts[0];
      domain = parts[1];

      loadInbox();
      setInterval(loadInbox, 10000); // auto refresh tiap 10 detik
    }

    // Load Inbox
    async function loadInbox() {
      let res = await fetch(https://www.1secmail.com/api/v1/?action=getMessages&login=${login}&domain=${domain});
      let data = await res.json();
      let inbox = document.getElementById("inbox");
      inbox.innerHTML = "";

      if (data.length === 0) {
        inbox.innerHTML = "<p class='text-gray-400'>Belum ada email masuk.</p>";
      } else {
        data.forEach(async msg => {
          let mailDetail = await fetch(https://www.1secmail.com/api/v1/?action=readMessage&login=${login}&domain=${domain}&id=${msg.id});
          let detail = await mailDetail.json();

          let div = document.createElement("div");
          div.className = "bg-gray-600 p-3 rounded-lg";
          div.innerHTML = `
            <p class="font-bold">${detail.from}</p>
            <p class="text-sm text-gray-300">${detail.subject}</p>
            <p class="text-xs text-gray-400">ID: ${detail.id}</p>
            <div class="mt-2 p-2 bg-gray-800 rounded">${detail.textBody || "Tidak ada isi."}</div>
          `;
          inbox.appendChild(div);
        });
      }
    }

    // Copy Email
    function copyEmail() {
      navigator.clipboard.writeText(email);
      alert("Email disalin: " + email);
    }

    generateEmail();
  </script>

</body>
</html>
